<apex:page controller="VerificationFormController" showHeader="false" sidebar="false">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f6f9;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #032d60;
            border-bottom: 2px solid #0176d3;
            padding-bottom: 10px;
        }
        .info-text {
            font-weight: bold;
            font-size: 14px;
            color: #032d60;
            margin: 20px 0;
            padding: 10px;
            background-color: #f3f3f3;
            border-left: 4px solid #0176d3;
        }
        .success-message {
            background-color: #4bca81;
            color: white;
            padding: 20px;
            border-radius: 4px;
            text-align: center;
        }
        .error-message {
            background-color: #ea001e;
            color: white;
            padding: 20px;
            border-radius: 4px;
            text-align: center;
        }
        .warning-message {
            background-color: #ffb75d;
            color: #333;
            padding: 20px;
            border-radius: 4px;
            text-align: center;
        }
        .form-section {
            margin: 20px 0;
        }
        label {
            display: block;
            font-weight: bold;
            margin: 15px 0 5px 0;
            color: #032d60;
        }
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #d8dde6;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        .submit-btn {
            background-color: #0176d3;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        .submit-btn:hover {
            background-color: #014486;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }
        .checkbox-container input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }
    </style>
    
    <div class="container">
        <apex:form >
            <apex:pageBlock rendered="{!isValidToken && !isSubmitted}">
                
                <h1>Reference Verification Form</h1>
                
                <apex:pageMessages />
                
                <div class="info-text">
                    Providing reference for: {!referencePerson.Your_Name__c}
                </div>
                
                <div class="form-section">
                    
                    <label>Is this person eligible? *</label>
                    <apex:selectList value="{!response.Is_Eligible__c}" size="1" required="true">
                        <apex:selectOption itemValue="" itemLabel="--Select--"/>
                        <apex:selectOption itemValue="Yes" itemLabel="Yes"/>
                        <apex:selectOption itemValue="No" itemLabel="No"/>
                        <apex:selectOption itemValue="Partially" itemLabel="Partially"/>
                    </apex:selectList>
                    
                    <label>Is this person trustable? *</label>
                    <apex:selectList value="{!response.Is_Trustable__c}" size="1" required="true">
                        <apex:selectOption itemValue="" itemLabel="--Select--"/>
                        <apex:selectOption itemValue="Yes" itemLabel="Yes"/>
                        <apex:selectOption itemValue="No" itemLabel="No"/>
                        <apex:selectOption itemValue="Uncertain" itemLabel="Uncertain"/>
                    </apex:selectList>
                    
                    <label>Overall Rating *</label>
                    <apex:selectList value="{!response.Overall_Rating__c}" size="1" required="true">
                        <apex:selectOption itemValue="" itemLabel="--Select--"/>
                        <apex:selectOption itemValue="Excellent" itemLabel="Excellent"/>
                        <apex:selectOption itemValue="Good" itemLabel="Good"/>
                        <apex:selectOption itemValue="Average" itemLabel="Average"/>
                        <apex:selectOption itemValue="Below Average" itemLabel="Below Average"/>
                        <apex:selectOption itemValue="Poor" itemLabel="Poor"/>
                    </apex:selectList>
                    
                    <label>Technical Skills Rating (1-10) *</label>
                    <apex:inputField value="{!response.Technical_Skills_Rating__c}" required="true"/>
                    
                    <label>Communication Skills Rating (1-10) *</label>
                    <apex:inputField value="{!response.Communication_Skills_Rating__c}" required="true"/>
                    
                    <label>Work Ethic Rating (1-10) *</label>
                    <apex:inputField value="{!response.Work_Ethic_Rating__c}" required="true"/>
                    
                    <label>Strengths *</label>
                    <apex:inputField value="{!response.Strengths__c}" required="true"/>
                    
                    <label>Areas of Improvement</label>
                    <apex:inputField value="{!response.Areas_of_Improvement__c}"/>
                    
                    <div class="checkbox-container">
                        <apex:inputField value="{!response.Would_Recommend__c}"/>
                        <label style="margin: 0;">Would you recommend this person?</label>
                    </div>
                    
                    <label>Additional Comments</label>
                    <apex:inputField value="{!response.Additional_Comments__c}"/>
                    
                </div>
                
                <apex:commandButton value="Submit Verification" action="{!submitVerification}" styleClass="submit-btn"/>
                
            </apex:pageBlock>
            
            <!-- Token Invalid or Expired -->
            <apex:outputPanel rendered="{!NOT(isValidToken) && NOT(isSubmitted) && NOT(isAlreadyUsed)}">
                <div class="error-message">
                    <h2>Invalid or Expired Token</h2>
                    <p>The verification link you used is either invalid or has expired.</p>
                </div>
            </apex:outputPanel>
            
            <!-- Token Already Used -->
            <apex:outputPanel rendered="{!isAlreadyUsed && NOT(isSubmitted)}">
                <div class="warning-message">
                    <h2>Link Already Used</h2>
                    <p>This verification link has already been used to submit a response.</p>
                    <p>Each verification link can only be used once for security purposes.</p>
                </div>
            </apex:outputPanel>
            
            <!-- Successfully Submitted -->
            <apex:outputPanel rendered="{!isSubmitted}">
                <div class="success-message">
                    <h2>Thank You!</h2>
                    <p>Your verification has been submitted successfully.</p>
                </div>
            </apex:outputPanel>
            
        </apex:form>
    </div>
</apex:page>